# 事業レポート機能 設計書

**作成日**: 2025年10月21日
**対象システム**: 行政事業レビュー サンキー図可視化アプリ

## 1. 概要

### 1.1 目的

事業単位で以下の情報を可視化し、予算の使われ方を時系列で分析できるようにする：

- 年度ごとの予算額・執行額の推移
- 事業の開始年度・終了予定年度
- 支出先のTop10とその推移
- 支出先ごとの年度をまたいだ金額推移

### 1.2 機能概要

| 機能名 | 説明 |
|--------|------|
| 事業検索・一覧 | 府省庁・事業名で検索し、事業一覧を表示 |
| 事業詳細レポート | 選択した事業の詳細情報とグラフを表示 |
| 予算推移グラフ | 2014-2024年の当初予算・執行額の折れ線グラフ |
| 支出先Top10 | 全期間累計での支出先ランキング |
| 支出先別推移グラフ | Top10支出先それぞれの年度別推移 |

## 2. データ構造設計

### 2.1 新規型定義

**ファイル**: `types/report.ts`

```typescript
/**
 * 事業の年度横断データ
 */
export interface ProjectTimeSeriesData {
  projectId: number;                    // 予算事業ID
  projectName: string;                  // 事業名
  ministry: string;                     // 府省庁
  startYear: Year;                      // データが存在する最初の年度
  endYear: Year;                        // データが存在する最後の年度
  yearlyData: {                         // 年度別データ
    [year: number]: {
      budget: number;                   // 当初予算（円）
      execution: number;                // 執行額（円）
      executionRate?: number;           // 執行率（0-1の小数）
    };
  };
  topExpenditures: ExpenditureTimeSeries[];  // 支出先Top10の推移
}

/**
 * 支出先の時系列データ
 */
export interface ExpenditureTimeSeries {
  name: string;                         // 支出先名
  totalAmount: number;                  // 全年度累計金額（円）
  yearCount: number;                    // 支出があった年度数
  yearlyAmounts: {                      // 年度別支出額
    [year: number]: number;
  };
}

/**
 * レポート表示用データ
 */
export interface ProjectReportData {
  project: ProjectTimeSeriesData;
  budgetTrend: BudgetTrendPoint[];
  expenditureTrend: ExpenditureGroupTrend[];
}

/**
 * 予算推移データポイント
 */
export interface BudgetTrendPoint {
  year: Year;
  budget: number;
  execution: number;
  executionRate?: number;
}

/**
 * 支出先グループの推移データ
 */
export interface ExpenditureGroupTrend {
  expenditureName: string;
  data: Array<{
    year: Year;
    amount: number;
  }>;
}

/**
 * 事業インデックス（検索用）
 */
export interface ProjectIndexItem {
  projectId: number;
  projectName: string;
  ministry: string;
  startYear: Year;
  endYear: Year;
  totalBudget: number;                  // 全期間の予算合計
  averageBudget: number;                // 年平均予算
}
```

### 2.2 生成されるJSONファイル

#### 2.2.1 プロジェクトインデックス

**パス**: `public/data/project-index.json`
**サイズ**: 約200-300KB
**用途**: 事業検索・一覧表示

```json
[
  {
    "projectId": 12345,
    "projectName": "○○推進事業",
    "ministry": "財務省",
    "startYear": 2014,
    "endYear": 2024,
    "totalBudget": 123456789000,
    "averageBudget": 11223344455
  },
  ...
]
```

#### 2.2.2 事業別詳細データ

**パス**: `public/data/projects/{projectId}.json`
**サイズ**: 1事業あたり約2-10KB
**用途**: 事業詳細レポート表示

```json
{
  "projectId": 12345,
  "projectName": "○○推進事業",
  "ministry": "財務省",
  "startYear": 2014,
  "endYear": 2024,
  "yearlyData": {
    "2014": {
      "budget": 10000000000,
      "execution": 9500000000,
      "executionRate": 0.95
    },
    "2015": { ... },
    ...
  },
  "topExpenditures": [
    {
      "name": "A株式会社",
      "totalAmount": 12345678900,
      "yearCount": 10,
      "yearlyAmounts": {
        "2014": 1234567890,
        "2015": 1234567890,
        ...
      }
    },
    ...
  ]
}
```

## 3. データ前処理設計

### 3.1 処理フロー

```
[全年度のCSVファイル]
      ↓
[年度別にパース・正規化]
      ↓
[事業ID単位で集約]
      ↓
[支出先データを事業別・年度別に集約]
      ↓
[支出先Top10を抽出]
      ↓
[2つのJSON出力]
  ├→ project-index.json (検索用)
  └→ projects/{projectId}.json (詳細用)
```

### 3.2 実装場所

**ファイル**: `scripts/preprocess-data.ts`

既存の `processYearData()` 関数の後に、新しい処理を追加：

```typescript
/**
 * 全年度のデータを集約して事業別時系列データを生成
 */
async function generateProjectTimeSeriesData() {
  console.log('\nGenerating project time series data...');

  // 1. 全年度のデータを読み込み
  const allYearsBudgetData = new Map<Year, any[]>();
  const allYearsExpenditureData = new Map<Year, any[]>();

  for (const year of AVAILABLE_YEARS) {
    const exists = await checkYearDirectoryExists(year);
    if (!exists) continue;

    const [budgetData, expenditureData] = await loadYearData(year);
    allYearsBudgetData.set(year, budgetData);
    allYearsExpenditureData.set(year, expenditureData);
  }

  // 2. 事業ID単位で集約
  const projectMap = new Map<number, ProjectTimeSeriesData>();

  for (const [year, budgetData] of allYearsBudgetData) {
    // 予算年度でフィルター
    const currentYearData = budgetData.filter(b => b.予算年度 === year);

    currentYearData.forEach(budget => {
      const projectId = budget.予算事業ID;
      if (!projectId) return;

      if (!projectMap.has(projectId)) {
        projectMap.set(projectId, {
          projectId,
          projectName: budget.事業名,
          ministry: budget.府省庁,
          startYear: year,
          endYear: year,
          yearlyData: {},
          topExpenditures: [],
        });
      }

      const project = projectMap.get(projectId)!;
      project.endYear = year; // 更新

      project.yearlyData[year] = {
        budget: normalizeAmount(budget['当初予算(合計)'], year),
        execution: normalizeAmount(budget['執行額(合計)'], year),
        executionRate: budget.執行率,
      };
    });
  }

  // 3. 支出先データを集約
  for (const [year, expenditureData] of allYearsExpenditureData) {
    // 事業年度でフィルター
    const currentYearData = expenditureData.filter(e => e.事業年度 === year);

    currentYearData.forEach(exp => {
      const projectId = exp.予算事業ID;
      if (!projectId || !projectMap.has(projectId)) return;

      const project = projectMap.get(projectId)!;
      const expenditureName = exp.支出先名;
      const amount = year === 2024
        ? (exp.金額 || 0)
        : normalizeAmount(exp['支出額（百万円）'] || 0, year);

      if (!expenditureName || !amount) return;

      // 支出先ごとに集約（一時的にMapで管理）
      if (!project._expenditureMap) {
        project._expenditureMap = new Map();
      }

      if (!project._expenditureMap.has(expenditureName)) {
        project._expenditureMap.set(expenditureName, {
          name: expenditureName,
          totalAmount: 0,
          yearCount: 0,
          yearlyAmounts: {},
        });
      }

      const expData = project._expenditureMap.get(expenditureName)!;
      expData.totalAmount += amount;

      if (!expData.yearlyAmounts[year]) {
        expData.yearlyAmounts[year] = 0;
        expData.yearCount++;
      }
      expData.yearlyAmounts[year] += amount;
    });
  }

  // 4. 各事業のTop10支出先を抽出
  projectMap.forEach(project => {
    if (project._expenditureMap) {
      const sorted = Array.from(project._expenditureMap.values())
        .sort((a, b) => b.totalAmount - a.totalAmount);

      project.topExpenditures = sorted.slice(0, 10);
      delete project._expenditureMap;
    }
  });

  // 5. インデックスファイルを生成
  const projectIndex: ProjectIndexItem[] = Array.from(projectMap.values())
    .map(p => {
      const years = Object.keys(p.yearlyData).map(Number);
      const totalBudget = years.reduce((sum, year) =>
        sum + (p.yearlyData[year]?.budget || 0), 0);

      return {
        projectId: p.projectId,
        projectName: p.projectName,
        ministry: p.ministry,
        startYear: p.startYear,
        endYear: p.endYear,
        totalBudget,
        averageBudget: totalBudget / years.length,
      };
    })
    .sort((a, b) => b.totalBudget - a.totalBudget);

  // 6. ファイル出力
  const projectsDir = path.join(OUTPUT_BASE_PATH, 'projects');
  await fs.mkdir(projectsDir, { recursive: true });

  // インデックスファイル
  await fs.writeFile(
    path.join(OUTPUT_BASE_PATH, 'project-index.json'),
    JSON.stringify(projectIndex, null, 2)
  );

  // 事業別詳細ファイル
  const writePromises = Array.from(projectMap.values()).map(project =>
    fs.writeFile(
      path.join(projectsDir, `${project.projectId}.json`),
      JSON.stringify(project, null, 2)
    )
  );

  await Promise.all(writePromises);

  console.log(`  ✓ Generated ${projectMap.size} project files`);
  console.log(`  ✓ Total index size: ${projectIndex.length} projects`);
}
```

### 3.3 注意事項

- **予算年度 vs 事業年度**: 予算データは `予算年度`、支出先データは `事業年度` でフィルター
- **金額の正規化**: 2014-2023は百万円単位、2024は円単位
- **支出先の名寄せ**: 同一事業・同一年度・同一支出先名で金額を合算
- **Top10の抽出**: 全年度の累計金額でソートして上位10件

## 4. UI設計

### 4.1 画面構成

```
/reports                    # 事業検索・一覧ページ
/reports/[projectId]        # 事業詳細レポートページ
```

### 4.2 レポート一覧ページ (`/reports`)

#### 4.2.1 ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────┐
│ ヘッダー                                      [年度選択] │
├─────────────────────────────────────────────────────────┤
│ パンくず: トップ > 事業レポート                         │
├─────────────────────────────────────────────────────────┤
│ 事業レポート                                            │
│                                                         │
│ ┌────────────────────┐  ┌─────────────────────────┐  │
│ │ 府省庁で絞り込み   │  │ 事業名で検索            │  │
│ │ [すべて ▼]         │  │ [_________________]      │  │
│ └────────────────────┘  └─────────────────────────┘  │
│                                                         │
│ 検索結果: 1,234件                                       │
│                                                         │
│ ┌─────────────────────────────────────────────────┐  │
│ │ 事業名           │府省庁│期間      │総予算    │  │
│ ├─────────────────────────────────────────────────┤  │
│ │ ○○推進事業      │財務省│2014-2024 │123億円   │→│
│ │ △△施策          │厚労省│2018-2024 │456億円   │→│
│ │ □□プロジェクト  │文科省│2014-2020 │789億円   │→│
│ │ ...                                              │  │
│ └─────────────────────────────────────────────────┘  │
│                                                         │
│ [< 前へ]  1 2 3 ... 50  [次へ >]                       │
└─────────────────────────────────────────────────────────┘
```

#### 4.2.2 コンポーネント構成

```typescript
// app/reports/page.tsx (Server Component)
export default async function ReportsPage() {
  const projectIndex = await loadProjectIndex();

  return (
    <div>
      <Header />
      <Breadcrumb items={['トップ', '事業レポート']} />
      <ProjectSearchInterface projectIndex={projectIndex} />
    </div>
  );
}

// client/components/reports/ProjectSearchInterface.tsx (Client Component)
'use client';

export function ProjectSearchInterface({
  projectIndex
}: {
  projectIndex: ProjectIndexItem[]
}) {
  const [ministryFilter, setMinistryFilter] = useState<string>('all');
  const [searchQuery, setSearchQuery] = useState<string>('');

  // Fuse.jsでインクリメンタルサーチ
  const fuse = useMemo(() => new Fuse(projectIndex, {
    keys: ['projectName'],
    threshold: 0.3,
  }), [projectIndex]);

  // フィルタリングロジック
  const filteredProjects = useMemo(() => {
    let results = projectIndex;

    if (ministryFilter !== 'all') {
      results = results.filter(p => p.ministry === ministryFilter);
    }

    if (searchQuery) {
      results = fuse.search(searchQuery).map(r => r.item);
    }

    return results;
  }, [projectIndex, ministryFilter, searchQuery, fuse]);

  return (
    <div>
      <ProjectFilters
        onMinistryChange={setMinistryFilter}
        onSearchChange={setSearchQuery}
      />
      <ProjectTable projects={filteredProjects} />
    </div>
  );
}
```

### 4.3 レポート詳細ページ (`/reports/[projectId]`)

#### 4.3.1 ワイヤーフレーム

```
┌─────────────────────────────────────────────────────────┐
│ ヘッダー                                      [年度選択] │
├─────────────────────────────────────────────────────────┤
│ パンくず: トップ > 事業レポート > ○○推進事業           │
├─────────────────────────────────────────────────────────┤
│ [← 一覧に戻る]                                          │
│                                                         │
│ 事業名: ○○推進事業                                     │
│ 府省庁: 財務省    事業ID: 12345                         │
│ 期間: 2014年度〜2024年度（11年間）                      │
├─────────────────────────────────────────────────────────┤
│ 【予算・執行額の推移】                                  │
│                                                         │
│  (億円)                                                 │
│  500 ┐                                                  │
│  400 ├───●───●───●── 当初予算                        │
│  300 │  ●       ●───●                                  │
│  200 │      ●           ●───●── 執行額                │
│  100 │                                                  │
│    0 └──┬───┬───┬───┬───┬───┬───┬───┬───┬───┬──  │
│       2014 2016 2018 2020 2022 2024                     │
├─────────────────────────────────────────────────────────┤
│ 【支出先Top10（全期間累計）】                           │
│                                                         │
│ 1. A株式会社         累計123億円  (10年間)             │
│ 2. B公益法人         累計 89億円  ( 8年間)             │
│ 3. C独立行政法人     累計 67億円  (11年間)             │
│ 4. D団体             累計 45億円  ( 6年間)             │
│ 5. E協会             累計 34億円  ( 9年間)             │
│ 6. F財団             累計 28億円  ( 7年間)             │
│ 7. G株式会社         累計 23億円  ( 5年間)             │
│ 8. H法人             累計 19億円  ( 8年間)             │
│ 9. I社               累計 15億円  ( 4年間)             │
│10. J機構             累計 12億円  ( 6年間)             │
├─────────────────────────────────────────────────────┤
│ 【支出先別推移】                                        │
│                                                         │
│ [Top5を表示 ▼] ☑ A社 ☑ B法人 ☑ C法人 □ D団体 □ E協会 │
│                                                         │
│  (億円)                                                 │
│   50 ┐                                                  │
│   40 ├──●──●──●──● [A社]                              │
│   30 │  ●──●──●──●──● [B法人]                         │
│   20 │    ●──●──●──● [C法人]                          │
│   10 │                                                  │
│    0 └──┬───┬───┬───┬───┬───┬───┬───┬───┬───┬──  │
│       2014 2016 2018 2020 2022 2024                     │
└─────────────────────────────────────────────────────────┘
```

#### 4.3.2 コンポーネント構成

```typescript
// app/reports/[projectId]/page.tsx (Server Component)
export default async function ProjectReportPage({
  params,
}: {
  params: { projectId: string };
}) {
  const projectData = await loadProjectData(Number(params.projectId));

  if (!projectData) {
    notFound();
  }

  return (
    <div>
      <Header />
      <Breadcrumb items={['トップ', '事業レポート', projectData.projectName]} />

      <ProjectHeader project={projectData} />

      <BudgetTrendChart data={projectData} />
      <ExpenditureTopList expenditures={projectData.topExpenditures} />
      <ExpenditureTimeSeriesChart
        projectId={projectData.projectId}
        expenditures={projectData.topExpenditures}
      />
    </div>
  );
}

// client/components/reports/BudgetTrendChart.tsx (Client Component)
'use client';

import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend } from 'recharts';

export function BudgetTrendChart({ data }: { data: ProjectTimeSeriesData }) {
  const chartData = Object.entries(data.yearlyData).map(([year, values]) => ({
    year: Number(year),
    budget: values.budget / 100000000, // 億円に変換
    execution: values.execution / 100000000,
  }));

  return (
    <section>
      <h2>予算・執行額の推移</h2>
      <LineChart width={800} height={400} data={chartData}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="year" />
        <YAxis label={{ value: '億円', angle: -90, position: 'insideLeft' }} />
        <Tooltip formatter={(value) => `${value.toFixed(1)}億円`} />
        <Legend />
        <Line
          type="monotone"
          dataKey="budget"
          name="当初予算"
          stroke="#3b82f6"
          strokeWidth={2}
        />
        <Line
          type="monotone"
          dataKey="execution"
          name="執行額"
          stroke="#10b981"
          strokeWidth={2}
        />
      </LineChart>
    </section>
  );
}

// client/components/reports/ExpenditureTopList.tsx (Client Component)
'use client';

export function ExpenditureTopList({
  expenditures
}: {
  expenditures: ExpenditureTimeSeries[]
}) {
  return (
    <section>
      <h2>支出先Top10（全期間累計）</h2>
      <ol>
        {expenditures.map((exp, index) => (
          <li key={index}>
            <span>{exp.name}</span>
            <span>累計{(exp.totalAmount / 100000000).toFixed(0)}億円</span>
            <span>({exp.yearCount}年間)</span>
          </li>
        ))}
      </ol>
    </section>
  );
}

// client/components/reports/ExpenditureTimeSeriesChart.tsx (Client Component)
'use client';

import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend } from 'recharts';
import { useState } from 'react';

const COLORS = ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6',
                '#ec4899', '#06b6d4', '#84cc16', '#f97316', '#14b8a6'];

export function ExpenditureTimeSeriesChart({
  expenditures
}: {
  expenditures: ExpenditureTimeSeries[]
}) {
  const [selectedExpenditures, setSelectedExpenditures] = useState<Set<string>>(
    new Set(expenditures.slice(0, 5).map(e => e.name))
  );

  // 年度のユニオン
  const allYears = Array.from(
    new Set(
      expenditures.flatMap(e => Object.keys(e.yearlyAmounts).map(Number))
    )
  ).sort();

  // チャートデータ生成
  const chartData = allYears.map(year => {
    const dataPoint: any = { year };

    expenditures.forEach(exp => {
      if (selectedExpenditures.has(exp.name)) {
        dataPoint[exp.name] = (exp.yearlyAmounts[year] || 0) / 100000000;
      }
    });

    return dataPoint;
  });

  const handleToggle = (name: string) => {
    setSelectedExpenditures(prev => {
      const next = new Set(prev);
      if (next.has(name)) {
        next.delete(name);
      } else {
        next.add(name);
      }
      return next;
    });
  };

  return (
    <section>
      <h2>支出先別推移</h2>

      <div>
        {expenditures.map((exp, index) => (
          <label key={exp.name}>
            <input
              type="checkbox"
              checked={selectedExpenditures.has(exp.name)}
              onChange={() => handleToggle(exp.name)}
            />
            <span style={{ color: COLORS[index % COLORS.length] }}>
              {exp.name}
            </span>
          </label>
        ))}
      </div>

      <LineChart width={800} height={400} data={chartData}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="year" />
        <YAxis label={{ value: '億円', angle: -90, position: 'insideLeft' }} />
        <Tooltip formatter={(value) => `${Number(value).toFixed(1)}億円`} />
        <Legend />
        {expenditures.map((exp, index) =>
          selectedExpenditures.has(exp.name) && (
            <Line
              key={exp.name}
              type="monotone"
              dataKey={exp.name}
              name={exp.name}
              stroke={COLORS[index % COLORS.length]}
              strokeWidth={2}
            />
          )
        )}
      </LineChart>
    </section>
  );
}
```

## 5. ディレクトリ構成

```
rs_system_pipeline_marumie/
├── app/
│   └── reports/
│       ├── page.tsx                          # 事業一覧ページ
│       └── [projectId]/
│           └── page.tsx                      # 事業詳細ページ
├── client/
│   └── components/
│       └── reports/
│           ├── ProjectSearchInterface.tsx    # 事業検索UI
│           ├── ProjectFilters.tsx            # フィルターコンポーネント
│           ├── ProjectTable.tsx              # 事業一覧テーブル
│           ├── ProjectHeader.tsx             # 事業情報ヘッダー
│           ├── BudgetTrendChart.tsx          # 予算推移グラフ
│           ├── ExpenditureTopList.tsx        # Top10リスト
│           └── ExpenditureTimeSeriesChart.tsx # 支出先推移グラフ
├── server/
│   └── loaders/
│       └── report-loader.ts                  # レポートデータローダー
├── types/
│   └── report.ts                             # レポート関連型定義
├── scripts/
│   └── preprocess-data.ts                    # データ前処理（拡張）
└── public/
    └── data/
        ├── project-index.json                # 事業インデックス
        └── projects/
            ├── 12345.json                    # 事業別詳細データ
            ├── 12346.json
            └── ...
```

## 6. 実装手順

### Phase 1: データ前処理の実装（優先度: 高）

1. `types/report.ts` を作成
2. `scripts/preprocess-data.ts` に `generateProjectTimeSeriesData()` を追加
3. `npm run preprocess` を実行してJSONファイルを生成
4. 1事業分のJSONを確認してデータ構造が正しいか検証

**期待される成果物**:
- `public/data/project-index.json`
- `public/data/projects/*.json`

### Phase 2: レポート一覧ページ（優先度: 高）

1. `server/loaders/report-loader.ts` を作成
   - `loadProjectIndex()` 関数を実装
2. `app/reports/page.tsx` を作成
3. `client/components/reports/ProjectSearchInterface.tsx` を作成
4. `client/components/reports/ProjectTable.tsx` を作成
5. Fuse.jsをインストール: `npm install fuse.js`

**期待される成果物**:
- `/reports` で事業一覧が表示される
- 府省庁フィルター、事業名検索が動作する

### Phase 3: レポート詳細ページ（優先度: 中）

1. `server/loaders/report-loader.ts` に追加
   - `loadProjectData(projectId)` 関数を実装
2. `app/reports/[projectId]/page.tsx` を作成
3. `client/components/reports/ProjectHeader.tsx` を作成
4. `client/components/reports/BudgetTrendChart.tsx` を作成
5. `client/components/reports/ExpenditureTopList.tsx` を作成
6. Rechartsをインストール: `npm install recharts`

**期待される成果物**:
- `/reports/12345` で事業詳細が表示される
- 予算推移グラフが表示される
- Top10リストが表示される

### Phase 4: 支出先推移グラフ（優先度: 中）

1. `client/components/reports/ExpenditureTimeSeriesChart.tsx` を作成
2. チェックボックスで表示する支出先を選択できるようにする
3. 複数の折れ線グラフを重ね表示

**期待される成果物**:
- 支出先の推移グラフが動作する
- Top10から任意の支出先を選択して表示できる

### Phase 5: UI/UX改善（優先度: 低）

1. レスポンシブ対応
2. ダークモード対応
3. ページネーション実装
4. ローディング状態の表示
5. エラーハンドリング

## 7. パフォーマンス最適化

### 7.1 データサイズ見積もり

| データ | サイズ | 備考 |
|--------|--------|------|
| project-index.json | 200-300KB | 全事業のメタデータ |
| 1事業あたりのJSON | 2-10KB | 年度データ + Top10支出先 |
| 全事業JSON合計 | 10-50MB | 5,000-10,000事業想定 |

### 7.2 最適化手法

1. **遅延ロード**: 詳細データは事業選択時にfetch
2. **インデックスファイル**: 検索用に軽量なインデックスのみ先読み
3. **静的生成**: 事業詳細ページは `generateStaticParams()` で事前生成
4. **キャッシュ**: fetch結果をクライアントサイドでキャッシュ

### 7.3 静的生成の実装

```typescript
// app/reports/[projectId]/page.tsx

export async function generateStaticParams() {
  const projectIndex = await loadProjectIndex();

  return projectIndex.map((project) => ({
    projectId: project.projectId.toString(),
  }));
}
```

## 8. テスト計画

### 8.1 データ検証

- [ ] 全年度のCSVが正しく読み込まれる
- [ ] 金額の正規化が正しく動作する（2014-2023: 百万円→円）
- [ ] 事業IDの重複がない
- [ ] 支出先Top10が正しく抽出される
- [ ] 年度範囲（startYear, endYear）が正しい

### 8.2 UI動作確認

- [ ] 事業一覧が表示される
- [ ] 府省庁フィルターが動作する
- [ ] 事業名検索が動作する
- [ ] 事業詳細ページに遷移できる
- [ ] 予算推移グラフが表示される
- [ ] Top10リストが表示される
- [ ] 支出先推移グラフが表示される
- [ ] チェックボックスで表示/非表示を切り替えられる

### 8.3 パフォーマンステスト

- [ ] 一覧ページの初期表示が2秒以内
- [ ] 検索のレスポンスが500ms以内
- [ ] 詳細ページの表示が2秒以内
- [ ] グラフの描画が1秒以内

## 9. 今後の拡張案

### 9.1 追加機能候補

- **CSV/Excelエクスポート**: レポートデータをダウンロード
- **比較機能**: 複数の事業を並べて比較
- **予測機能**: 過去データから将来の予算を予測
- **アラート機能**: 予算増減が大きい事業を通知
- **ブックマーク**: 気になる事業を保存

### 9.2 データ分析機能

- **支出先分析**: 同じ支出先が受注している事業一覧
- **府省庁横断分析**: 類似事業の府省庁間比較
- **執行率分析**: 執行率の低い事業の分析

## 10. 補足事項

### 10.1 データの制約

- **事業IDの一意性**: 同じ事業IDが複数年にわたって継続する保証はない
- **事業名の揺れ**: 同じ事業でも年度によって名前が微妙に異なる可能性がある
- **支出先の名寄せ**: 表記揺れ（株式会社/㈱、スペースの有無など）は考慮していない
- **金額の欠損**: 一部の年度でデータが欠けている場合がある

### 10.2 ユーザビリティ

- **初期表示**: デフォルトで予算規模の大きい事業を上位表示
- **パンくず**: 一覧に戻りやすいナビゲーション
- **ツールチップ**: グラフ上でホバーすると詳細情報を表示
- **レスポンシブ**: モバイルでも閲覧可能なデザイン

---

**以上**
